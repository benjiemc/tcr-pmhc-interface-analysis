

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Comparing apo and holo CDR loop clustering &mdash; tcr_pmhc_interface_analysis  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Comparison of apo and **holo* CDR loops" href="Comparison_of_apo_and_holo_CDR_loops.html" />
    <link rel="prev" title="Centre of mass analysis" href="Centre_of_mass_analysis.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            tcr_pmhc_interface_analysis
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Analysis Results</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="notebooks.html">Analysis Notebooks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Ascertaining_the_generalisability_of_the_structure_data.html">Ascertaining the generalisability of the structure data</a></li>
<li class="toctree-l2"><a class="reference internal" href="Centre_of_mass_analysis.html">Centre of mass analysis</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Comparing <em>apo</em> and <em>holo</em> CDR loop clustering</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Compare-apo-and-holo-forms-of-loops">Compare <em>apo</em> and <em>holo</em> forms of loops</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Comparison_of_apo_and_holo_CDR_loops.html">Comparison of <em>apo</em> and **holo* CDR loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="Identify_contact_residues_on_MHC_Class_I_molecules.html">Identify contact residues on MHC Class I molecules</a></li>
<li class="toctree-l2"><a class="reference internal" href="Length_dependency_of_conformational_change.html">Length dependency of conformational change</a></li>
<li class="toctree-l2"><a class="reference internal" href="Per_residue_changes_of_TCR_CDR_between_apo_and_holo_structures.html">Per residue changes of TCR CDRs between apo and holo structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="Summary_of_apo_holo_data.html">Summary of <em>apo</em>-<em>holo</em> data</a></li>
<li class="toctree-l2"><a class="reference internal" href="Visualising_CDR_loop_clustering.html">Visualising CDR loop clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="pMHC_movement_based_on_peptide_anchoring.html">pMHC movement based on peptide anchoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="pMHC_movement_between_apo_and_holo_conformations.html">pMHC movement between apo and holo conformations</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Command Line Applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="apps.html">Command Line Applications</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">tcr_pmhc_interface_analysis</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tcr_pmhc_interface_analysis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="notebooks.html">Analysis Notebooks</a></li>
      <li class="breadcrumb-item active">Comparing <em>apo</em> and <em>holo</em> CDR loop clustering</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/source/Comparing_of_apo_and_holo_CDR_loop_clustering.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Comparing-apo-and-holo-CDR-loop-clustering">
<h1>Comparing <em>apo</em> and <em>holo</em> CDR loop clustering<a class="headerlink" href="#Comparing-apo-and-holo-CDR-loop-clustering" title="Link to this heading"></a></h1>
<section id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Link to this heading"></a></h2>
<p>In this notebook, we set out to assess whether the CDR loops of TCRs stay in there canonical forms between <em>apo</em> and <em>holo</em> states or if they disrupt them.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import itertools

import matplotlib.pyplot as plt
import pandas as pd
import seaborn as sns
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df = pd.read_csv(&#39;../data/processed/stcrdab_clusters.csv&#39;)
df
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>cluster</th>
      <th>chain_type</th>
      <th>cdr</th>
      <th>sequence</th>
      <th>cluster_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7zt2_DE</td>
      <td>12</td>
      <td>alpha_chain</td>
      <td>1</td>
      <td>TSGFNG</td>
      <td>pseudo</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7zt3_DE</td>
      <td>12</td>
      <td>alpha_chain</td>
      <td>1</td>
      <td>TSGFNG</td>
      <td>pseudo</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7zt4_DE</td>
      <td>12</td>
      <td>alpha_chain</td>
      <td>1</td>
      <td>TSGFNG</td>
      <td>pseudo</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7zt5_DE</td>
      <td>12</td>
      <td>alpha_chain</td>
      <td>1</td>
      <td>TSGFNG</td>
      <td>pseudo</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7zt7_DE</td>
      <td>12</td>
      <td>alpha_chain</td>
      <td>1</td>
      <td>TSGFNG</td>
      <td>pseudo</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4807</th>
      <td>6miv_CD</td>
      <td>22</td>
      <td>beta_chain</td>
      <td>3</td>
      <td>ASGDEGYTQY</td>
      <td>canonical</td>
    </tr>
    <tr>
      <th>4808</th>
      <td>3rtq_CD</td>
      <td>22</td>
      <td>beta_chain</td>
      <td>3</td>
      <td>ASGDEGYTQY</td>
      <td>canonical</td>
    </tr>
    <tr>
      <th>4809</th>
      <td>3dxa_NO</td>
      <td>noise</td>
      <td>beta_chain</td>
      <td>3</td>
      <td>ASRYRDDSYNEQF</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4810</th>
      <td>1d9k_AB</td>
      <td>noise</td>
      <td>beta_chain</td>
      <td>3</td>
      <td>ASGGQGRAEQF</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4811</th>
      <td>4gg6_GH</td>
      <td>noise</td>
      <td>beta_chain</td>
      <td>3</td>
      <td>ASSVAVSAGTYEQY</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>4812 rows × 6 columns</p>
</div></div>
</div>
</section>
<section id="Compare-apo-and-holo-forms-of-loops">
<h2>Compare <em>apo</em> and <em>holo</em> forms of loops<a class="headerlink" href="#Compare-apo-and-holo-forms-of-loops" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>apo_holo_summary_df = pd.read_csv(&#39;../data/processed/apo-holo-tcr-pmhc-class-I/apo_holo_summary.csv&#39;)
apo_holo_summary_df
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>file_name</th>
      <th>pdb_id</th>
      <th>structure_type</th>
      <th>state</th>
      <th>alpha_chain</th>
      <th>beta_chain</th>
      <th>antigen_chain</th>
      <th>mhc_chain1</th>
      <th>mhc_chain2</th>
      <th>cdr_sequences_collated</th>
      <th>peptide_sequence</th>
      <th>mhc_slug</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1ao7_D-E-C-A-B_tcr_pmhc.pdb</td>
      <td>1ao7</td>
      <td>tcr_pmhc</td>
      <td>holo</td>
      <td>D</td>
      <td>E</td>
      <td>C</td>
      <td>A</td>
      <td>B</td>
      <td>DRGSQS-IYSNGD-AVTTDSWGKLQ-MNHEY-SVGAGI-ASRPGLA...</td>
      <td>LLFGYPVYV</td>
      <td>hla_a_02_01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1bd2_D-E-C-A-B_tcr_pmhc.pdb</td>
      <td>1bd2</td>
      <td>tcr_pmhc</td>
      <td>holo</td>
      <td>D</td>
      <td>E</td>
      <td>C</td>
      <td>A</td>
      <td>B</td>
      <td>NSMFDY-ISSIKDK-AAMEGAQKLV-MNHEY-SVGAGI-ASSYPGG...</td>
      <td>LLFGYPVYV</td>
      <td>hla_a_02_01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1bii_A-B-P_pmhc.pdb</td>
      <td>1bii</td>
      <td>pmhc</td>
      <td>apo</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P</td>
      <td>A</td>
      <td>B</td>
      <td>NaN</td>
      <td>RGPGRAFVTI</td>
      <td>h2_dd</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1ddh_A-B-P_pmhc.pdb</td>
      <td>1ddh</td>
      <td>pmhc</td>
      <td>apo</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>P</td>
      <td>A</td>
      <td>B</td>
      <td>NaN</td>
      <td>RGPGRAFVTI</td>
      <td>h2_dd</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1duz_A-B-C_pmhc.pdb</td>
      <td>1duz</td>
      <td>pmhc</td>
      <td>apo</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C</td>
      <td>A</td>
      <td>B</td>
      <td>NaN</td>
      <td>LLFGYPVYV</td>
      <td>hla_a_02_01</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>353</th>
      <td>8gon_D-E-C-A-B_tcr_pmhc.pdb</td>
      <td>8gon</td>
      <td>tcr_pmhc</td>
      <td>holo</td>
      <td>D</td>
      <td>E</td>
      <td>C</td>
      <td>A</td>
      <td>B</td>
      <td>TSESDYY-QEAYKQQN-ASSGNTPLV-SGHNS-FNNNVP-ASTWGR...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>354</th>
      <td>8gop_A-B_tcr.pdb</td>
      <td>8gop</td>
      <td>tcr</td>
      <td>apo</td>
      <td>A</td>
      <td>B</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TSESDYY-QEAYKQQN-ASSGNTPLV-SGHNS-FNNNVP-ASTWGR...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>355</th>
      <td>8gvb_A-B-P-H-L_tcr_pmhc.pdb</td>
      <td>8gvb</td>
      <td>tcr_pmhc</td>
      <td>holo</td>
      <td>A</td>
      <td>B</td>
      <td>P</td>
      <td>H</td>
      <td>L</td>
      <td>YGATPY-YFSGDTLV-AVGFTGGGNKLT-SEHNR-FQNEAQ-ASSD...</td>
      <td>RYPLTFGW</td>
      <td>hla_a_24_02</td>
    </tr>
    <tr>
      <th>356</th>
      <td>8gvg_A-B-P-H-L_tcr_pmhc.pdb</td>
      <td>8gvg</td>
      <td>tcr_pmhc</td>
      <td>holo</td>
      <td>A</td>
      <td>B</td>
      <td>P</td>
      <td>H</td>
      <td>L</td>
      <td>YGATPY-YFSGDTLV-AVGFTGGGNKLT-SEHNR-FQNEAQ-ASSD...</td>
      <td>RFPLTFGW</td>
      <td>hla_a_24_02</td>
    </tr>
    <tr>
      <th>357</th>
      <td>8gvi_A-B-P-H-L_tcr_pmhc.pdb</td>
      <td>8gvi</td>
      <td>tcr_pmhc</td>
      <td>holo</td>
      <td>A</td>
      <td>B</td>
      <td>P</td>
      <td>H</td>
      <td>L</td>
      <td>YGATPY-YFSGDTLV-AVVFTGGGNKLT-SEHNR-FQNEAQ-ASSL...</td>
      <td>RYPLTFGW</td>
      <td>hla_a_24_02</td>
    </tr>
  </tbody>
</table>
<p>358 rows × 12 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df[[&#39;pdb_id&#39;, &#39;chains&#39;]] = df[&#39;name&#39;].str.split(&#39;_&#39;).apply(pd.Series)
df[[&#39;alpha_chain&#39;, &#39;beta_chain&#39;]] = df[&#39;chains&#39;].apply(list).apply(pd.Series)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>apo_holo_clusters = df.merge(apo_holo_summary_df,
                             how=&#39;inner&#39;,
                             on=[&#39;pdb_id&#39;, &#39;alpha_chain&#39;, &#39;beta_chain&#39;])
apo_holo_clusters
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>cluster</th>
      <th>chain_type</th>
      <th>cdr</th>
      <th>sequence</th>
      <th>cluster_type</th>
      <th>pdb_id</th>
      <th>chains</th>
      <th>alpha_chain</th>
      <th>beta_chain</th>
      <th>file_name</th>
      <th>structure_type</th>
      <th>state</th>
      <th>antigen_chain</th>
      <th>mhc_chain1</th>
      <th>mhc_chain2</th>
      <th>cdr_sequences_collated</th>
      <th>peptide_sequence</th>
      <th>mhc_slug</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8gom_DE</td>
      <td>4</td>
      <td>alpha_chain</td>
      <td>1</td>
      <td>TSESDYY</td>
      <td>canonical</td>
      <td>8gom</td>
      <td>DE</td>
      <td>D</td>
      <td>E</td>
      <td>8gom_D-E-C-A-B_tcr_pmhc.pdb</td>
      <td>tcr_pmhc</td>
      <td>holo</td>
      <td>C</td>
      <td>A</td>
      <td>B</td>
      <td>TSESDYY-QEAYKQQN-ASSGNTPLV-SGHNS-FNNNVP-ASTWGR...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8gom_DE</td>
      <td>4</td>
      <td>beta_chain</td>
      <td>1</td>
      <td>SGHNS</td>
      <td>canonical</td>
      <td>8gom</td>
      <td>DE</td>
      <td>D</td>
      <td>E</td>
      <td>8gom_D-E-C-A-B_tcr_pmhc.pdb</td>
      <td>tcr_pmhc</td>
      <td>holo</td>
      <td>C</td>
      <td>A</td>
      <td>B</td>
      <td>TSESDYY-QEAYKQQN-ASSGNTPLV-SGHNS-FNNNVP-ASTWGR...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8gom_DE</td>
      <td>3</td>
      <td>alpha_chain</td>
      <td>2</td>
      <td>QEAYKQQN</td>
      <td>canonical</td>
      <td>8gom</td>
      <td>DE</td>
      <td>D</td>
      <td>E</td>
      <td>8gom_D-E-C-A-B_tcr_pmhc.pdb</td>
      <td>tcr_pmhc</td>
      <td>holo</td>
      <td>C</td>
      <td>A</td>
      <td>B</td>
      <td>TSESDYY-QEAYKQQN-ASSGNTPLV-SGHNS-FNNNVP-ASTWGR...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8gom_DE</td>
      <td>2</td>
      <td>beta_chain</td>
      <td>2</td>
      <td>FNNNVP</td>
      <td>canonical</td>
      <td>8gom</td>
      <td>DE</td>
      <td>D</td>
      <td>E</td>
      <td>8gom_D-E-C-A-B_tcr_pmhc.pdb</td>
      <td>tcr_pmhc</td>
      <td>holo</td>
      <td>C</td>
      <td>A</td>
      <td>B</td>
      <td>TSESDYY-QEAYKQQN-ASSGNTPLV-SGHNS-FNNNVP-ASTWGR...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8gom_DE</td>
      <td>noise</td>
      <td>alpha_chain</td>
      <td>3</td>
      <td>ASSGNTPLV</td>
      <td>NaN</td>
      <td>8gom</td>
      <td>DE</td>
      <td>D</td>
      <td>E</td>
      <td>8gom_D-E-C-A-B_tcr_pmhc.pdb</td>
      <td>tcr_pmhc</td>
      <td>holo</td>
      <td>C</td>
      <td>A</td>
      <td>B</td>
      <td>TSESDYY-QEAYKQQN-ASSGNTPLV-SGHNS-FNNNVP-ASTWGR...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1189</th>
      <td>3dxa_NO</td>
      <td>4</td>
      <td>beta_chain</td>
      <td>1</td>
      <td>SEHNR</td>
      <td>canonical</td>
      <td>3dxa</td>
      <td>NO</td>
      <td>N</td>
      <td>O</td>
      <td>3dxa_N-O-M-K-L_tcr_pmhc.pdb</td>
      <td>tcr_pmhc</td>
      <td>holo</td>
      <td>M</td>
      <td>K</td>
      <td>L</td>
      <td>TISGNEY-GLKNN-IVWGGYQKVT-SEHNR-FQNEAQ-ASRYRDDS...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1190</th>
      <td>3dxa_NO</td>
      <td>noise</td>
      <td>alpha_chain</td>
      <td>2</td>
      <td>GLKNN</td>
      <td>NaN</td>
      <td>3dxa</td>
      <td>NO</td>
      <td>N</td>
      <td>O</td>
      <td>3dxa_N-O-M-K-L_tcr_pmhc.pdb</td>
      <td>tcr_pmhc</td>
      <td>holo</td>
      <td>M</td>
      <td>K</td>
      <td>L</td>
      <td>TISGNEY-GLKNN-IVWGGYQKVT-SEHNR-FQNEAQ-ASRYRDDS...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1191</th>
      <td>3dxa_NO</td>
      <td>2</td>
      <td>beta_chain</td>
      <td>2</td>
      <td>FQNEAQ</td>
      <td>canonical</td>
      <td>3dxa</td>
      <td>NO</td>
      <td>N</td>
      <td>O</td>
      <td>3dxa_N-O-M-K-L_tcr_pmhc.pdb</td>
      <td>tcr_pmhc</td>
      <td>holo</td>
      <td>M</td>
      <td>K</td>
      <td>L</td>
      <td>TISGNEY-GLKNN-IVWGGYQKVT-SEHNR-FQNEAQ-ASRYRDDS...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1192</th>
      <td>3dxa_NO</td>
      <td>6</td>
      <td>alpha_chain</td>
      <td>3</td>
      <td>IVWGGYQKVT</td>
      <td>canonical</td>
      <td>3dxa</td>
      <td>NO</td>
      <td>N</td>
      <td>O</td>
      <td>3dxa_N-O-M-K-L_tcr_pmhc.pdb</td>
      <td>tcr_pmhc</td>
      <td>holo</td>
      <td>M</td>
      <td>K</td>
      <td>L</td>
      <td>TISGNEY-GLKNN-IVWGGYQKVT-SEHNR-FQNEAQ-ASRYRDDS...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1193</th>
      <td>3dxa_NO</td>
      <td>noise</td>
      <td>beta_chain</td>
      <td>3</td>
      <td>ASRYRDDSYNEQF</td>
      <td>NaN</td>
      <td>3dxa</td>
      <td>NO</td>
      <td>N</td>
      <td>O</td>
      <td>3dxa_N-O-M-K-L_tcr_pmhc.pdb</td>
      <td>tcr_pmhc</td>
      <td>holo</td>
      <td>M</td>
      <td>K</td>
      <td>L</td>
      <td>TISGNEY-GLKNN-IVWGGYQKVT-SEHNR-FQNEAQ-ASRYRDDS...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1194 rows × 19 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def collate_clusters(group):
    apo_clusters = sorted(group.query(&quot;state == &#39;apo&#39;&quot;)[&#39;cluster&#39;].tolist())
    holo_clusters = sorted(group.query(&quot;state == &#39;holo&#39;&quot;)[&#39;cluster&#39;].tolist())

    return pd.Series({&#39;apo_clusters&#39;: apo_clusters, &#39;holo_clusters&#39;: holo_clusters})

apo_holo_clusters_agg = apo_holo_clusters.groupby([&#39;cdr_sequences_collated&#39;,
                                                   &#39;chain_type&#39;,
                                                   &#39;cdr&#39;]).apply(collate_clusters).reset_index()
apo_holo_clusters_agg
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cdr_sequences_collated</th>
      <th>chain_type</th>
      <th>cdr</th>
      <th>apo_clusters</th>
      <th>holo_clusters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ATGYPS-ATKADDK-ALSDPVNDMR-SGHAT-FQNNGV-ASSLRGR...</td>
      <td>alpha_chain</td>
      <td>1</td>
      <td>[13]</td>
      <td>[noise, noise]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ATGYPS-ATKADDK-ALSDPVNDMR-SGHAT-FQNNGV-ASSLRGR...</td>
      <td>alpha_chain</td>
      <td>2</td>
      <td>[noise]</td>
      <td>[noise, noise]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ATGYPS-ATKADDK-ALSDPVNDMR-SGHAT-FQNNGV-ASSLRGR...</td>
      <td>alpha_chain</td>
      <td>3</td>
      <td>[noise]</td>
      <td>[noise, noise]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ATGYPS-ATKADDK-ALSDPVNDMR-SGHAT-FQNNGV-ASSLRGR...</td>
      <td>beta_chain</td>
      <td>1</td>
      <td>[4]</td>
      <td>[4, 4]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ATGYPS-ATKADDK-ALSDPVNDMR-SGHAT-FQNNGV-ASSLRGR...</td>
      <td>beta_chain</td>
      <td>2</td>
      <td>[2]</td>
      <td>[2, 2]</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>385</th>
      <td>YSGSPE-HISR-ALSGFNNAGNMLT-SGHAT-FQNNGV-ASSLGGA...</td>
      <td>alpha_chain</td>
      <td>2</td>
      <td>[noise]</td>
      <td>[noise]</td>
    </tr>
    <tr>
      <th>386</th>
      <td>YSGSPE-HISR-ALSGFNNAGNMLT-SGHAT-FQNNGV-ASSLGGA...</td>
      <td>alpha_chain</td>
      <td>3</td>
      <td>[noise]</td>
      <td>[2]</td>
    </tr>
    <tr>
      <th>387</th>
      <td>YSGSPE-HISR-ALSGFNNAGNMLT-SGHAT-FQNNGV-ASSLGGA...</td>
      <td>beta_chain</td>
      <td>1</td>
      <td>[4]</td>
      <td>[4]</td>
    </tr>
    <tr>
      <th>388</th>
      <td>YSGSPE-HISR-ALSGFNNAGNMLT-SGHAT-FQNNGV-ASSLGGA...</td>
      <td>beta_chain</td>
      <td>2</td>
      <td>[2]</td>
      <td>[2]</td>
    </tr>
    <tr>
      <th>389</th>
      <td>YSGSPE-HISR-ALSGFNNAGNMLT-SGHAT-FQNNGV-ASSLGGA...</td>
      <td>beta_chain</td>
      <td>3</td>
      <td>[noise]</td>
      <td>[noise]</td>
    </tr>
  </tbody>
</table>
<p>390 rows × 5 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cluster_types = (df[[&#39;chain_type&#39;, &#39;cdr&#39;, &#39;cluster&#39;, &#39;cluster_type&#39;]].drop_duplicates()
                                                                     .set_index([&#39;chain_type&#39;, &#39;cdr&#39;, &#39;cluster&#39;])
                                                                     [&#39;cluster_type&#39;])
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def classify_movement(chain_type: str,
                      cdr: str,
                      apo_clusters: list[str],
                      holo_clusters: list[str],
                      cluster_types: pd.Series) -&gt; pd.Series:
    types = {
        &#39;Noise&#39;: 0,
        &#39;Noise to Canonical Cluster&#39;: 0,
        &#39;Noise to Pseudo Cluster&#39;: 0,
        &#39;Canonical Cluster to Noise&#39;: 0,
        &#39;Pseudo Cluster to Noise&#39;: 0,
        &#39;Canonical Cluster Shift&#39;: 0,
        &#39;Pseudo Cluster Shift&#39;: 0,
        &#39;Canonical to Pseudo&#39;: 0,
        &#39;Pseudo to Canonical&#39;: 0,
        &#39;Canonical Cluster Same&#39;: 0,
        &#39;Pseudo Cluster Same&#39;: 0,
    }

    for apo_clust, holo_clust in itertools.product(apo_clusters, holo_clusters):
        if apo_clust == &#39;noise&#39; and holo_clust == &#39;noise&#39;:
            types[&#39;Noise&#39;] += 1

        elif apo_clust == &#39;noise&#39; and holo_clust != &#39;noise&#39;:
            if cluster_types.loc[chain_type, cdr, holo_clust] == &#39;canonical&#39;:
                 types[&#39;Noise to Canonical Cluster&#39;] += 1

            else:
                types[&#39;Noise to Pseudo Cluster&#39;] += 1

        elif apo_clust != &#39;noise&#39; and holo_clust == &#39;noise&#39;:
            if cluster_types.loc[chain_type, cdr, apo_clust] == &#39;canonical&#39;:
                 types[&#39;Canonical Cluster to Noise&#39;] += 1

            else:
                types[&#39;Pseudo Cluster to Noise&#39;] += 1

        elif apo_clust != holo_clust:
            if (cluster_types.loc[chain_type, cdr, apo_clust]
                == cluster_types.loc[chain_type, cdr, holo_clust]
                == &#39;canonical&#39;):
                 types[&#39;Canonical Cluster Shift&#39;] += 1

            elif (cluster_types.loc[chain_type, cdr, apo_clust] == &#39;canonical&#39;
                  and cluster_types.loc[chain_type, cdr, holo_clust] == &#39;pseudo&#39;):
                types[&#39;Canonical to Pseudo&#39;] += 1

            else:
                types[&#39;Pseudo to Canonical&#39;] += 1

        elif apo_clust == holo_clust:
            if cluster_types.loc[chain_type, cdr, apo_clust] == &#39;canonical&#39;:
                types[&#39;Canonical Cluster Same&#39;] += 1

            else:
                types[&#39;Pseudo Cluster Same&#39;] += 1

    return pd.Series(types)


apo_holo_clusters_agg = apo_holo_clusters_agg.join(apo_holo_clusters_agg.apply(
    lambda row: classify_movement(row.chain_type, row.cdr, row.apo_clusters, row.holo_clusters, cluster_types), axis=1
))

# Wide to long
apo_holo_clusters_agg = apo_holo_clusters_agg.melt(id_vars=[&#39;cdr_sequences_collated&#39;, &#39;chain_type&#39;, &#39;cdr&#39;],
                                                 value_vars=[&#39;Noise&#39;,
                                                             &#39;Noise to Canonical Cluster&#39;,
                                                             &#39;Noise to Pseudo Cluster&#39;,
                                                             &#39;Canonical Cluster to Noise&#39;,
                                                             &#39;Pseudo Cluster to Noise&#39;,
                                                             &#39;Canonical Cluster Shift&#39;,
                                                             &#39;Pseudo Cluster Shift&#39;,
                                                             &#39;Canonical to Pseudo&#39;,
                                                             &#39;Pseudo to Canonical&#39;,
                                                             &#39;Canonical Cluster Same&#39;,
                                                             &#39;Pseudo Cluster Same&#39;],
                                                 var_name=&#39;types&#39;, value_name=&#39;count&#39;)

# Normalize for differeing group sizes
apo_holo_clusters_agg = apo_holo_clusters_agg.groupby(
    [&#39;cdr_sequences_collated&#39;, &#39;chain_type&#39;, &#39;cdr&#39;, &#39;types&#39;],
)[&#39;count&#39;].median().reset_index()
apo_holo_clusters_agg
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cdr_sequences_collated</th>
      <th>chain_type</th>
      <th>cdr</th>
      <th>types</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ATGYPS-ATKADDK-ALSDPVNDMR-SGHAT-FQNNGV-ASSLRGR...</td>
      <td>alpha_chain</td>
      <td>1</td>
      <td>Canonical Cluster Same</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ATGYPS-ATKADDK-ALSDPVNDMR-SGHAT-FQNNGV-ASSLRGR...</td>
      <td>alpha_chain</td>
      <td>1</td>
      <td>Canonical Cluster Shift</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ATGYPS-ATKADDK-ALSDPVNDMR-SGHAT-FQNNGV-ASSLRGR...</td>
      <td>alpha_chain</td>
      <td>1</td>
      <td>Canonical Cluster to Noise</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ATGYPS-ATKADDK-ALSDPVNDMR-SGHAT-FQNNGV-ASSLRGR...</td>
      <td>alpha_chain</td>
      <td>1</td>
      <td>Canonical to Pseudo</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ATGYPS-ATKADDK-ALSDPVNDMR-SGHAT-FQNNGV-ASSLRGR...</td>
      <td>alpha_chain</td>
      <td>1</td>
      <td>Noise</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4285</th>
      <td>YSGSPE-HISR-ALSGFNNAGNMLT-SGHAT-FQNNGV-ASSLGGA...</td>
      <td>beta_chain</td>
      <td>3</td>
      <td>Noise to Pseudo Cluster</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4286</th>
      <td>YSGSPE-HISR-ALSGFNNAGNMLT-SGHAT-FQNNGV-ASSLGGA...</td>
      <td>beta_chain</td>
      <td>3</td>
      <td>Pseudo Cluster Same</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4287</th>
      <td>YSGSPE-HISR-ALSGFNNAGNMLT-SGHAT-FQNNGV-ASSLGGA...</td>
      <td>beta_chain</td>
      <td>3</td>
      <td>Pseudo Cluster Shift</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4288</th>
      <td>YSGSPE-HISR-ALSGFNNAGNMLT-SGHAT-FQNNGV-ASSLGGA...</td>
      <td>beta_chain</td>
      <td>3</td>
      <td>Pseudo Cluster to Noise</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4289</th>
      <td>YSGSPE-HISR-ALSGFNNAGNMLT-SGHAT-FQNNGV-ASSLGGA...</td>
      <td>beta_chain</td>
      <td>3</td>
      <td>Pseudo to Canonical</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>4290 rows × 5 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>apo_holo_clusters_agg
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cdr_sequences_collated</th>
      <th>chain_type</th>
      <th>cdr</th>
      <th>types</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ATGYPS-ATKADDK-ALSDPVNDMR-SGHAT-FQNNGV-ASSLRGR...</td>
      <td>alpha_chain</td>
      <td>1</td>
      <td>Canonical Cluster Same</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ATGYPS-ATKADDK-ALSDPVNDMR-SGHAT-FQNNGV-ASSLRGR...</td>
      <td>alpha_chain</td>
      <td>1</td>
      <td>Canonical Cluster Shift</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ATGYPS-ATKADDK-ALSDPVNDMR-SGHAT-FQNNGV-ASSLRGR...</td>
      <td>alpha_chain</td>
      <td>1</td>
      <td>Canonical Cluster to Noise</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ATGYPS-ATKADDK-ALSDPVNDMR-SGHAT-FQNNGV-ASSLRGR...</td>
      <td>alpha_chain</td>
      <td>1</td>
      <td>Canonical to Pseudo</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ATGYPS-ATKADDK-ALSDPVNDMR-SGHAT-FQNNGV-ASSLRGR...</td>
      <td>alpha_chain</td>
      <td>1</td>
      <td>Noise</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4285</th>
      <td>YSGSPE-HISR-ALSGFNNAGNMLT-SGHAT-FQNNGV-ASSLGGA...</td>
      <td>beta_chain</td>
      <td>3</td>
      <td>Noise to Pseudo Cluster</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4286</th>
      <td>YSGSPE-HISR-ALSGFNNAGNMLT-SGHAT-FQNNGV-ASSLGGA...</td>
      <td>beta_chain</td>
      <td>3</td>
      <td>Pseudo Cluster Same</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4287</th>
      <td>YSGSPE-HISR-ALSGFNNAGNMLT-SGHAT-FQNNGV-ASSLGGA...</td>
      <td>beta_chain</td>
      <td>3</td>
      <td>Pseudo Cluster Shift</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4288</th>
      <td>YSGSPE-HISR-ALSGFNNAGNMLT-SGHAT-FQNNGV-ASSLGGA...</td>
      <td>beta_chain</td>
      <td>3</td>
      <td>Pseudo Cluster to Noise</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4289</th>
      <td>YSGSPE-HISR-ALSGFNNAGNMLT-SGHAT-FQNNGV-ASSLGGA...</td>
      <td>beta_chain</td>
      <td>3</td>
      <td>Pseudo to Canonical</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>4290 rows × 5 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>g = sns.catplot(apo_holo_clusters_agg.sort_values([&#39;chain_type&#39;, &#39;cdr&#39;, &#39;types&#39;]),
                row=&#39;chain_type&#39;, col=&#39;cdr&#39;,
                x=&#39;types&#39;, y=&#39;count&#39;,
                kind=&#39;bar&#39;)

for ax in g.axes.flat:
    labels = ax.get_xticklabels()
    plt.setp(labels, rotation=90)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/source_Comparing_of_apo_and_holo_CDR_loop_clustering_12_0.png" src="../_images/source_Comparing_of_apo_and_holo_CDR_loop_clustering_12_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cluster_shift_counts = apo_holo_clusters_agg.groupby([&#39;chain_type&#39;, &#39;cdr&#39;, &#39;types&#39;])[&#39;count&#39;].sum().astype(int)
cluster_shift_counts[cluster_shift_counts &gt; 0]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
chain_type   cdr  types
alpha_chain  1    Canonical Cluster Same        112
                  Canonical Cluster to Noise      9
                  Canonical to Pseudo             7
                  Noise                           8
                  Noise to Canonical Cluster     11
                  Noise to Pseudo Cluster        13
                  Pseudo Cluster Same            10
                  Pseudo to Canonical             8
             2    Canonical Cluster Same         95
                  Canonical Cluster to Noise      5
                  Noise                          15
                  Noise to Canonical Cluster      9
                  Pseudo Cluster Same            28
                  Pseudo Cluster to Noise        26
             3    Canonical Cluster Same         39
                  Canonical Cluster to Noise     12
                  Noise                          24
                  Noise to Canonical Cluster     16
                  Noise to Pseudo Cluster        40
                  Pseudo Cluster Same            46
                  Pseudo Cluster to Noise         1
beta_chain   1    Canonical Cluster Same        142
                  Canonical Cluster Shift        29
                  Noise to Canonical Cluster      2
                  Pseudo Cluster Same             5
             2    Canonical Cluster Same         71
                  Canonical Cluster Shift         2
                  Canonical Cluster to Noise      8
                  Noise                          84
                  Noise to Canonical Cluster      2
                  Noise to Pseudo Cluster         6
                  Pseudo Cluster to Noise         5
             3    Canonical Cluster Same          5
                  Noise                          48
                  Noise to Canonical Cluster     11
                  Noise to Pseudo Cluster        32
                  Pseudo Cluster Same            79
                  Pseudo Cluster to Noise         3
Name: count, dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>export_cluster_shift_counts = cluster_shift_counts.to_frame().reset_index()

export_cluster_shift_counts = export_cluster_shift_counts.rename({&#39;types&#39;: &#39;Movement Type&#39;}, axis=&#39;columns&#39;)

export_cluster_shift_counts[&#39;CDR Type&#39;] = export_cluster_shift_counts.apply(
    lambda row: f&quot;CDR{row.cdr}\\text{row.chain_type.split(&#39;_&#39;)[0]}{{}}&quot;,
    axis=&#39;columns&#39;,
)

export_cluster_shift_counts = export_cluster_shift_counts.pivot(index=&#39;Movement Type&#39;,
                                                                columns=&#39;CDR Type&#39;,
                                                                values=&#39;count&#39;)
export_cluster_shift_counts = export_cluster_shift_counts.sort_values(&#39;Movement Type&#39;)

export_cluster_shift_counts = export_cluster_shift_counts.replace(0, &#39;-&#39;)
export_cluster_shift_counts = export_cluster_shift_counts.sort_index()
export_cluster_shift_counts.columns.name = None
export_cluster_shift_counts = export_cluster_shift_counts.reset_index()

export_cluster_shift_counts
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/var/scratch/bmcmaste/1908294/ipykernel_260472/2849749015.py:21: FutureWarning: In future versions `DataFrame.to_latex` is expected to utilise the base implementation of `Styler.to_latex` for formatting and rendering. The arguments signature may therefore change. It is recommended instead to use `DataFrame.style.to_latex` which also contains additional functionality.
  fh.write(export_cluster_shift_counts.to_latex(escape=False, index=False))
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Movement Type</th>
      <th>CDR1\textalpha{}</th>
      <th>CDR1\textbeta{}</th>
      <th>CDR2\textalpha{}</th>
      <th>CDR2\textbeta{}</th>
      <th>CDR3\textalpha{}</th>
      <th>CDR3\textbeta{}</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Canonical Cluster Same</td>
      <td>112</td>
      <td>142</td>
      <td>95</td>
      <td>71</td>
      <td>39</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Canonical Cluster Shift</td>
      <td>-</td>
      <td>29</td>
      <td>-</td>
      <td>2</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Canonical Cluster to Noise</td>
      <td>9</td>
      <td>-</td>
      <td>5</td>
      <td>8</td>
      <td>12</td>
      <td>-</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Canonical to Pseudo</td>
      <td>7</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Noise</td>
      <td>8</td>
      <td>-</td>
      <td>15</td>
      <td>84</td>
      <td>24</td>
      <td>48</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Noise to Canonical Cluster</td>
      <td>11</td>
      <td>2</td>
      <td>9</td>
      <td>2</td>
      <td>16</td>
      <td>11</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Noise to Pseudo Cluster</td>
      <td>13</td>
      <td>-</td>
      <td>-</td>
      <td>6</td>
      <td>40</td>
      <td>32</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Pseudo Cluster Same</td>
      <td>10</td>
      <td>5</td>
      <td>28</td>
      <td>-</td>
      <td>46</td>
      <td>79</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Pseudo Cluster Shift</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Pseudo Cluster to Noise</td>
      <td>-</td>
      <td>-</td>
      <td>26</td>
      <td>5</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Pseudo to Canonical</td>
      <td>8</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Conclusion">
<h2>Conclusion<a class="headerlink" href="#Conclusion" title="Link to this heading"></a></h2>
<p>The analysis here shows that for the most part, the CDR-1s and CDR-2s stay in their canonical forms between <em>apo</em> and <em>holo</em> states where as the CDR-3 loops have a variety of modes. As expected, it is more difficult to cluster the CDR-3 loops as they are more structurally diverse.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Centre_of_mass_analysis.html" class="btn btn-neutral float-left" title="Centre of mass analysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Comparison_of_apo_and_holo_CDR_loops.html" class="btn btn-neutral float-right" title="Comparison of apo and **holo* CDR loops" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Benjamin McMaster.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>